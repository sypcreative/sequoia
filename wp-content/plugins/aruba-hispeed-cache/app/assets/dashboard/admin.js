!function(){"use strict";var e,a={760:function(e,a,t){var n=window.wp.element,c=window.lodash,r=window.wp.components,l=window.wp.data,s=window.wp.notices;const o=()=>{const e=(0,l.useSelect)((e=>e(s.store).getNotices()),[]),{removeNotice:a}=(0,l.useDispatch)(s.store),t=(0,c.filter)(e,{type:"snackbar"});return t.length>=1?(0,n.createElement)(r.SnackbarList,{notices:t,className:"components-editor-notices__snackbar",onRemove:a}):""},i=()=>{const e=(0,l.useSelect)((e=>e(s.store).getNotices())),{removeNotice:a}=(0,l.useDispatch)(s.store),t=(0,c.filter)(e,{type:"default"});return t.length>=1?(0,n.createElement)(r.NoticeList,{notices:t,onRemove:a}):""};var h=window.wp.i18n,u=e=>{let{setActive:a,isActive:t}=e;const c=[];return c.push({name:"general",title:(0,h.__)("General","aruba-hispeed-cache"),className:"general-tab"}),!0===t&&"true"===window.ahscUtils.const.isDebug&&c.push({name:"debug",title:(0,h.__)("Debug","aruba-hispeed-cache"),className:"debug-tab"}),(0,n.createElement)("header",{className:"ahsc-header"},(0,n.createElement)("div",{className:"ahsc-container"},(0,n.createElement)("div",{className:"ahsc-logo"},(0,n.createElement)("img",{src:window.ahscUtils.const.logosrc,title:(0,h.__)("Aruba HiSpeed Cache interfaces directly with the Aruba HiSpeed Cache service of the Aruba hosting platform and automates its management.","aruba-hispeed-cache")}),(0,n.createElement)("h1",{className:"title"},"Aruba HiSpeed Cache"),(0,n.createElement)("abbr",{title:(0,h.sprintf)((0,h.__)("Version: %s","aruba-hispeed-cache"),window.ahscUtils.const.version),className:"version"},window.ahscUtils.const.version)),(0,n.createElement)(r.TabPanel,{className:"ahs-tab-panel",activeClass:"ahs-active-tab",orientation:"horizontal",initialTabName:"general",tabs:c},(e=>a(e.name)))))},d=e=>{let{status:a,getOption:t,updateOption:c}=e;const l=t();return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Purging options","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("Enable automatic purge","aruba-hispeed-cache"),help:(0,h.__)("Enable automatic purge","aruba-hispeed-cache"),checked:Boolean(l.ahsc_enable_purge),disabled:"saving"===a,onChange:e=>c(l,"ahsc_enable_purge",e)}))),(0,n.createElement)(r.Panel,{header:(0,h.__)("Automatically purge entire cache when:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Home page:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("A post (or page/custom post) is modified or added.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_homepage_on_edit),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_homepage_on_edit",e)})),(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("A published post (or page/custom post)  is deleted","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_homepage_on_del),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_homepage_on_del",e)}))),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Post/page/custom post type:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("A post is published","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_page_on_mod),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_page_on_mod",e)})),(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("A comment is published.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_page_on_new_comment),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_page_on_new_comment",e)})),(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("A comment is not approved or is deleted","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_page_on_deleted_comment),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_page_on_deleted_comment",e)}))),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Archive:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("a post (or page/custom post) is modified or added.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_archive_on_edit),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_archive_on_edit",e)})),(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("a published post (or page/custom post) is cancelled.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_archive_on_del),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_archive_on_del",e)}))),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Comments:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("a comment is approved/published.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_archive_on_new_comment),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_archive_on_new_comment",e)})),(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("a comment is unapproved/deleted.","aruba-hispeed-cache"),checked:Boolean(l.ahsc_purge_archive_on_deleted_comment),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_purge_archive_on_deleted_comment",e)}))),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Cache Warming:","aruba-hispeed-cache")},(0,n.createElement)(r.PanelRow,null,(0,n.createElement)(r.ToggleControl,{label:(0,h.__)("Enable Cache Warming.","aruba-hispeed-cache"),help:(0,n.createElement)(n.Fragment,null,(0,h.__)("Cache Warming is the process through which webpages are preloaded in the cache so they can be displayed quicker","aruba-hispeed-cache"),(0,n.createElement)("br",null),(0,h.__)("When the cache is cleaned, the homepages and last ten posts are automatically preloaded in the cache so they can be displayed quicker.","aruba-hispeed-cache")),checked:Boolean(l.ahsc_cache_warmer),disabled:"saving"===a||!1===Boolean(l.ahsc_enable_purge),onChange:e=>c(l,"ahsc_cache_warmer",e)})))))};async function p(e){const a=function(e){const a={url:encodeURIComponent(e)};let t="https://www.googleapis.com/pagespeedonline/v5/runPagespeed?";for(let e in a)t+=`${e}=${a[e]}`;return t}(e);return await fetch(a).then((e=>e.json())).then((e=>(console.log(e),e)))}function m(e){return(0,n.createElement)(r.Notice,{id:e.notice.handle,status:e.notice.type,isDismissible:!1},(0,n.createElement)("p",{dangerouslySetInnerHTML:{__html:e.notice.message}}))}window.wp.htmlEntities;var _=()=>{const[e,a]=(0,n.useState)(!1),[t,l]=(0,n.useState)(!1),[s,o]=(0,n.useState)(!1),i=e=>{if((0,c.has)(e,"error"))return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("p",null,(0,h.__)("An error occurred, please try again later.","aruba-hispeed-cache")))};return!1===e?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,{className:["center"]},(0,n.createElement)(r.Button,{variant:"secondary",onClick:async()=>(async()=>{a("loading");const e=await p(window.ahscUtils.const.homePage),t=await p(window.ahscUtils.const.homePage+"?no-cache=true");a("loaded"),l(e),o(t)})()},(0,h.__)("Run comparative PageSpeed","aruba-hispeed-cache")))):"loading"===e?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Loading parameters without cache.","aruba-hispeed-cache")},(0,n.createElement)("span",{class:"center"},(0,n.createElement)(r.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}}))),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Loading parameters with cache.","aruba-hispeed-cache")},(0,n.createElement)("span",{class:"center"},(0,n.createElement)(r.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}})))):"loaded"===e?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Report Google PageSpeed Api with cache","aruba-hispeed-cache")},i(t)),(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Report Google PageSpeed Api without cache","aruba-hispeed-cache")},i(s))):void 0},g=()=>{const[e,a]=(0,n.useState)(!0),[t,c]=(0,n.useState)(!1),[l,s]=(0,n.useState)("loading"),[o,i]=(0,n.useState)([]);return(0,n.useEffect)((()=>{a(!1),c(window.ahscUtils.const.duBugFile)}),[]),(0,n.useEffect)((()=>{(async function(){return await fetch(window.ahscUtils.const.homePage).then((e=>[...e.headers])).catch((e=>(console.log(e),!1)))})().then((e=>{s("loaded"),Array.isArray(e)?i(e):i([(0,h.__)("An unexpected error occurred, please check your browser console or try again later.","aruba-hispeed-cache")])}))}),[]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)((()=>!0===e?(0,n.createElement)(r.PanelBody,{className:["center"]},(0,n.createElement)(r.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}})):!1===e&&!1!==t?(0,n.createElement)(r.PanelBody,null,(0,n.createElement)(r.TextareaControl,{label:(0,h.__)("Purging Log setting","aruba-hispeed-cache"),value:t,rows:"15",className:["log-list-field"],readOnly:!0})):(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Purging Log setting","aruba-hispeed-cache"),className:["center"]},(0,n.createElement)("p",null,(0,h.__)("The log file was not created or has been automatically removed because the WordPress debugging feature is not enabled.","aruba-hispeed-cache")))),null),(0,n.createElement)((()=>"loading"===l?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Check in progress","aruba-hispeed-cache")},(0,n.createElement)("span",{className:"center"},(0,n.createElement)(r.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}})))):"loaded"===l?(0,n.createElement)(r.PanelBody,{title:(0,h.__)("Check request header","aruba-hispeed-cache")},(0,n.createElement)("dl",null,o.map((e=>Array.isArray(e)?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("dt",null,e[0]),(0,n.createElement)("dd",null,e[1])):(0,n.createElement)(n.Fragment,null,(0,n.createElement)("dt",null,e)))))):void 0),null))},b=window.wp.apiFetch,E=t.n(b),w=()=>{const[e,a]=(0,n.useState)(!1),t=()=>a(!1),[c,o]=(0,n.useState)(!1),{createNotice:i}=(0,l.useDispatch)(s.store);return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.PanelBody,null,(0,n.createElement)("div",{className:"ahsc-info"},(0,n.createElement)("h3",null,(0,h.__)("Actions on request","aruba-hispeed-cache")),(0,n.createElement)("div",{className:"ahsc-info-button-group"},(0,n.createElement)(r.Button,{variant:"primary",isPrimary:!0,onClick:()=>a(!0)},(0,h.__)("Purge cache","aruba-hispeed-cache"))))),(0,n.createElement)(n.Fragment,null,e&&(0,n.createElement)(r.Modal,{title:(0,h.__)("Purging cache","aruba-hispeed-cache"),onRequestClose:t},(0,n.createElement)("p",null,(0,h.__)("You are about to purge the entire cache. Are you sure you want to continue?","aruba-hispeed-cache")),(0,n.createElement)(r.Button,{variant:"primary",onClick:async()=>{let e=window.ahscUtils.const.purger;o(!0);const a=new FormData;a.append("action","ahcs_clear_cache"),a.append("ahsc_nonce",e.ahsc_nonce),a.append("ahsc_to_purge",e.ahsc_topurge),await E()({method:"POST",url:e.ahsc_ajax_url,body:a}).then((e=>{e.code>=200&&(i(e.type,e.message,{isDismissible:!0}),t(),o(!1))}))}},(0,h.__)("Purge cache","aruba-hispeed-cache"),c&&(0,n.createElement)(r.Spinner,null)))))},v=e=>{let{currentTab:a,setTab:t,settings:c}=e;const[l,s,o,i]=c();return"loading"===o?(0,n.createElement)(r.Placeholder,null,(0,n.createElement)(r.Spinner,null)):(0,n.createElement)(n.StrictMode,null,(0,n.createElement)(n.Fragment,null,(0,n.createElement)(u,{setActive:t,isActive:i}),null!==window.ahscUtils.const.servCheck.notice&&(0,n.createElement)(m,{notice:window.ahscUtils.const.servCheck.notice}),(0,n.createElement)("div",{className:`ahsc-main is-${a}`},(0,n.createElement)("div",{className:"ahsc-left"},(0,n.createElement)((()=>{switch(a){case"speed-test":return(0,n.createElement)(_,null);case"debug":return(0,n.createElement)(g,null);case"general":return(0,n.createElement)(d,{status:o,getOption:l,updateOption:s})}}),null)),(0,n.createElement)("div",{className:"ahsc-right"},(0,n.createElement)(w,null)))))},y=window.wp.api,f=t.n(y),P=()=>{const{createNotice:e}=(0,l.useDispatch)(s.store),{createErrorNotice:a}=(0,l.useDispatch)(s.store),{createSuccessNotice:t}=(0,l.useDispatch)(s.store),[c,r]=(0,n.useState)({}),[o,i]=(0,n.useState)("loading"),[u,d]=(0,n.useState)(!1),p=()=>{f().loadPromise.then((async()=>{try{const e=new(f().models.Settings),a=await e.fetch();r(a),d(Boolean(null==a?void 0:a.aruba_hispeed_cache_options.ahsc_enable_purge))}catch(e){i("error")}finally{i("loaded")}}))};return(0,n.useEffect)((()=>{p()}),[]),[()=>null==c?void 0:c.aruba_hispeed_cache_options,function(n,c,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,h.__)("Settings saved.","aruba-hispeed-cache");i("saving"),n[c]=r;const s=new(f().models.Settings)({aruba_hispeed_cache_options:n}).save();s.success(((r,s)=>{"success"===s&&(i("loaded"),"ahsc_enable_purge"===c?(d(n.ahsc_enable_purge),!1===n.ahsc_enable_purge&&a((0,h.__)("The clearing function of the Aruba HiSpeed Cache plugin has been disabled.","aruba-hispeed-cache"),{isDismissible:!0}),!0===n.ahsc_enable_purge&&t((0,h.__)("The clearing function of the Aruba HiSpeed Cache plugin has been activated.","aruba-hispeed-cache","aruba-hispeed-cache"),{isDismissible:!0})):e("success",l,{isDismissible:!0,type:"snackbar"})),"error"===s&&(i("error"),e("error",(0,h.__)("An error occurred, please try again later.","aruba-hispeed-cache"),{isDismissible:!0,type:"snackbar"})),p()})),s.error((a=>{i("error"),e("error",a.responseJSON.message?a.responseJSON.message:(0,h.__)("An error occurred, please try again later.","aruba-hispeed-cache"),{isDismissible:!0,type:"snackbar"})}))},o,u]};void 0===window.ahscUtils&&(window.ahscUtils={}),window.ahscUtils.const=ahscisleGutenberg,window.ahscUtils.useSettings=P;const B=document.getElementById("ahsc-settings");(0,n.createRoot)(B).render((0,n.createElement)((()=>{const[e,a]=(0,n.useState)("general");return(0,n.createElement)(n.Fragment,null,void 0!==wp.notices.store&&(0,n.createElement)(i,null),void 0!==wp.notices.store&&(0,n.createElement)(o,null),(0,n.createElement)(v,{currentTab:e,setTab:a,settings:P}))}),null))}},t={};function n(e){var c=t[e];if(void 0!==c)return c.exports;var r=t[e]={exports:{}};return a[e](r,r.exports,n),r.exports}n.m=a,e=[],n.O=function(a,t,c,r){if(!t){var l=1/0;for(h=0;h<e.length;h++){t=e[h][0],c=e[h][1],r=e[h][2];for(var s=!0,o=0;o<t.length;o++)(!1&r||l>=r)&&Object.keys(n.O).every((function(e){return n.O[e](t[o])}))?t.splice(o--,1):(s=!1,r<l&&(l=r));if(s){e.splice(h--,1);var i=c();void 0!==i&&(a=i)}}return a}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[t,c,r]},n.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(a,{a:a}),a},n.d=function(e,a){for(var t in a)n.o(a,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},n.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},function(){var e={328:0,72:0};n.O.j=function(a){return 0===e[a]};var a=function(a,t){var c,r,l=t[0],s=t[1],o=t[2],i=0;if(l.some((function(a){return 0!==e[a]}))){for(c in s)n.o(s,c)&&(n.m[c]=s[c]);if(o)var h=o(n)}for(a&&a(t);i<l.length;i++)r=l[i],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(h)},t=self.webpackChunkaruba_hispeed_cache=self.webpackChunkaruba_hispeed_cache||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var c=n.O(void 0,[72],(function(){return n(760)}));c=n.O(c)}();